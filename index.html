<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="user-scalable=0" />
<title>AssemblyScript Aggregations Test</title>
<link rel="icon" href="https://assemblyscript.org/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="result"></div>
<script>"use strict";

var resultElem = document.getElementById("result");

// Compute the size of and instantiate the module's memory
var memory = new WebAssembly.Memory({ initial: 1 });

// Fetch and instantiate the module
fetch("build/optimized.wasm")
.then(response => response.arrayBuffer())
.then(buffer => WebAssembly.instantiate(buffer, {
  env: {
    memory,
    abort(...args) {
      console.log(...args);
    }
  },
  Math
}))
.then(module => {
  var exports = module.instance.exports;
  var result = exports.add(1, 1);
  resultElem.innerHTML = result;
}).catch(err => {
  console.log("Failed to load WASM: ", err.message);
  console.log(err.stack);
});
</script>
</body>
</html>
